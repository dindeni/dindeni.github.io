!function(t){var e={};function i(s){if(e[s])return e[s].exports;var n=e[s]={i:s,l:!1,exports:{}};return t[s].call(n.exports,n,n.exports,i),n.l=!0,n.exports}i.m=t,i.c=e,i.d=function(t,e,s){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:s})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var s=Object.create(null);if(i.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)i.d(s,n,function(e){return t[e]}.bind(null,n));return s},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s=2)}([function(t,e,i){(function(i){var s,n,a;n=[],void 0===(a="function"==typeof(s=function(){"use strict";function e(t,e,i){var s=new XMLHttpRequest;s.open("GET",t),s.responseType="blob",s.onload=function(){h(s.response,e,i)},s.onerror=function(){console.error("could not download file")},s.send()}function s(t){var e=new XMLHttpRequest;return e.open("HEAD",t,!1),e.send(),200<=e.status&&299>=e.status}function n(t){try{t.dispatchEvent(new MouseEvent("click"))}catch(i){var e=document.createEvent("MouseEvents");e.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),t.dispatchEvent(e)}}var a="object"==typeof window&&window.window===window?window:"object"==typeof self&&self.self===self?self:"object"==typeof i&&i.global===i?i:void 0,h=a.saveAs||"object"!=typeof window||window!==a?function(){}:"download"in HTMLAnchorElement.prototype?function(t,i,h){var c=a.URL||a.webkitURL,o=document.createElement("a");i=i||t.name||"download",o.download=i,o.rel="noopener","string"==typeof t?(o.href=t,o.origin===location.origin?n(o):s(o.href)?e(t,i,h):n(o,o.target="_blank")):(o.href=c.createObjectURL(t),setTimeout(function(){c.revokeObjectURL(o.href)},4e4),setTimeout(function(){n(o)},0))}:"msSaveOrOpenBlob"in navigator?function(t,i,a){if(i=i||t.name||"download","string"!=typeof t)navigator.msSaveOrOpenBlob(function(t,e){return void 0===e?e={autoBom:!1}:"object"!=typeof e&&(console.warn("Depricated: Expected third argument to be a object"),e={autoBom:!e}),e.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(t.type)?new Blob(["\ufeff",t],{type:t.type}):t}(t,a),i);else if(s(t))e(t,i,a);else{var h=document.createElement("a");h.href=t,h.target="_blank",setTimeout(function(){n(h)})}}:function(t,i,s,n){if((n=n||open("","_blank"))&&(n.document.title=n.document.body.innerText="downloading..."),"string"==typeof t)return e(t,i,s);var h="application/octet-stream"===t.type,c=/constructor/i.test(a.HTMLElement)||a.safari,o=/CriOS\/[\d]+/.test(navigator.userAgent);if((o||h&&c)&&"object"==typeof FileReader){var r=new FileReader;r.onloadend=function(){var t=r.result;t=o?t:t.replace(/^data:[^;]*;/,"data:attachment/file;"),n?n.location.href=t:location=t,n=null},r.readAsDataURL(t)}else{var d=a.URL||a.webkitURL,g=d.createObjectURL(t);n?n.location=g:location.href=g,n=null,setTimeout(function(){d.revokeObjectURL(g)},4e4)}};a.saveAs=h.saveAs=h,t.exports=h})?s.apply(e,n):s)||(t.exports=a)}).call(this,i(1))},function(t,e){var i;i=function(){return this}();try{i=i||new Function("return this")()}catch(t){"object"==typeof window&&(i=window)}t.exports=i},function(t,e,i){"use strict";i.r(e);const s=document.querySelector(".content"),n=document.createElement("span"),a=t=>{n.classList.add("error");const e=s.appendChild(n);e.textContent=t,e.addEventListener("click",t=>{t.target===e&&e.remove()}),setTimeout(()=>{e.remove()},5e3)};var h=i(0),c=i.n(h);const o=()=>{const t=document.querySelector(".content");if(null===t.querySelector(".content__rotate-button")){const e=document.createElement("div");t.appendChild(e),e.classList.add("content__rotate-wrapper");const i=document.createElement("button");i.classList.add("content__rotate-button"),i.classList.add("button"),i.textContent="rotate",e.appendChild(i)}const e=document.querySelector(".aside___form"),i=(document.querySelector("#size"),document.querySelectorAll(".aside__icon"),document.querySelectorAll(".aside__input")),s=document.querySelector(".content__rotate-button");i.checked=!0,s.style.display="none",i[0].checked=!0,u();e.addEventListener("change",t=>{for(let t=0;t<i.length;t++){if(i[t].checked&&"rotate"===i[t].id)return s.style.display="block";s.style.display="none"}})};class r extends Image{constructor(t){super(),this.allowedExtensions=/(\.jpg|\.jpeg|\.png)$/i,this.inputElement=document.querySelector(".content__input"),this.reader=new FileReader,this.canvas=document.querySelector(".content__canvas"),this.canvasWrapper=document.querySelector(".content__canvas-wrapper"),this.video=document.querySelector(".content__video")}loadImageReader(){this.inputElement.addEventListener("change",t=>{if(this.file=t.target.files[0],!this.allowedExtensions.exec(this.file.name))return a('Error: allowed file extension: "png", "jpg"');this.reader.addEventListener("load",()=>{this.loadImg(),this.save(),this.video.style.display="none",o()});this.reader.readAsDataURL(this.file)})}renderCanvas(){this.canvas.width=this.image.width,this.canvas.height=this.image.height,this.ctx=this.canvas.getContext("2d"),this.ctx.drawImage(this.image,0,0),this.canvasWrapper.style.maxWidth=`${this.canvas.width}px`}controller(){}loadImg(){this.image=new Image,this.image.addEventListener("load",()=>{this.controller()}),this.image.src=this.reader.result}}const d=new class extends r{constructor(){super(),this.content=document.querySelector(".content")}greyScale(){this.ctx=this.canvas.getContext("2d"),this.imageData=this.ctx.getImageData(0,0,this.canvas.width,this.canvas.height),this.data=this.imageData.data;for(let t=0;t<this.data.length;t+=4)this.avg=(this.data[t]+this.data[t+1]+this.data[t+2])/3,this.data[t]=this.avg,this.data[t+1]=this.avg,this.data[t+2]=this.avg;this.ctx.putImageData(this.imageData,0,0)}inversion(){this.ctx=this.canvas.getContext("2d"),this.imageData=this.ctx.getImageData(0,0,this.canvas.width,this.canvas.height),this.data=this.imageData.data;for(let t=0;t<this.data.length;t+=4)this.data[t]=255-this.data[t],this.data[t+1]=255-this.data[t+1],this.data[t+2]=255-this.data[t+2];this.ctx.putImageData(this.imageData,0,0)}brightness(){this.rangeBrightness=document.querySelector("#range-brightness"),this.ctx=this.canvas.getContext("2d"),this.imageData=this.ctx.getImageData(0,0,this.canvas.width,this.canvas.height),this.data=this.imageData.data;for(let t=0;t<this.data.length;t+=4)this.data[t]+=this.rangeBrightness.value/100*255,this.data[t+1]+=this.rangeBrightness.value/100*255,this.data[t+2]+=this.rangeBrightness.value/100*255;this.ctx.putImageData(this.imageData,0,0)}contrast(){this.rangeContrast=document.querySelector("#range-contrast"),this.ctx=this.canvas.getContext("2d"),this.imageData=this.ctx.getImageData(0,0,this.canvas.width,this.canvas.height),this.data=this.imageData.data,this.contrastValue=parseInt(this.rangeContrast.value),this.factor=259*(this.contrastValue+255)/(255*(259-this.contrastValue));for(let t=0;t<this.data.length;t+=4)this.data[t]=this.factor*(this.data[t]-128)+128,this.data[t+1]=this.factor*(this.data[t+1]-128)+128,this.data[t+2]=this.factor*(this.data[t+2]-128)+128;this.ctx.putImageData(this.imageData,0,0)}save(){}};i.d(e,"changeInputColor",function(){return u}),(new class extends r{constructor(){super(),this.form=document.querySelector(".aside___form"),this.inputSize=document.querySelector("#size"),this.iconSvg=document.querySelectorAll(".aside__icon"),this.asideInput=document.querySelectorAll(".aside__input"),this.brightnessWrapper=document.querySelector(".content__range-wrapper--brightness"),this.contrastWrapper=document.querySelector(".content__range-wrapper--contrast"),this.scaleX=1,this.scaleY=1}canvasControls(){this.ctxIconLeft=this.canvas.getContext("2d"),this.svgIconPlus=new Image,this.svgIconPlus.src="icon/plus-button.svg",this.svgIconLeftY=this.canvas.height/2-this.svgSize.height/2,this.svgIconLeftX=this.svgMargin/2,this.svgIconPlus.addEventListener("load",()=>{this.ctxIconLeft.drawImage(this.svgIconPlus,this.svgIconLeftX,this.svgIconLeftY,this.svgSize.width,this.svgSize.height)}),this.ctxIconRight=this.canvas.getContext("2d"),this.svgIconMinus=new Image,this.svgIconMinus.src="icon/minus-button.svg",this.svgIconRightX=this.canvas.width-this.svgSize.width-this.svgMargin/2,this.svgIconMinus.addEventListener("load",()=>{this.ctxIconRight.drawImage(this.svgIconMinus,this.svgIconRightX,this.svgIconLeftY,this.svgSize.width,this.svgSize.height)})}iconHover(){this.hover=(t=>{t.clientX>this.canvas.getBoundingClientRect().left+this.svgMargin/2&&t.clientX<this.canvas.getBoundingClientRect().left+this.svgSize.width-this.svgMargin/2&&t.clientY>this.canvas.getBoundingClientRect().top+this.canvas.clientHeight/2-this.svgSize.height/2&&t.clientY<this.canvas.getBoundingClientRect().top+this.canvas.clientHeight/2+this.svgSize.height/2?this.svgIconPlus.src="icon/plus-button-hover.svg":this.svgIconPlus.src="icon/plus-button.svg",t.clientX>this.canvas.getBoundingClientRect().left+this.canvas.clientWidth-this.svgSize.width+this.svgMargin/2&&t.clientX<this.canvas.getBoundingClientRect().left+this.canvas.clientWidth-this.svgMargin/2&&t.clientY>this.canvas.getBoundingClientRect().top+this.canvas.clientHeight/2-this.svgSize.height/2&&t.clientY<this.canvas.getBoundingClientRect().top+this.canvas.clientHeight/2+this.svgSize.height/2?this.svgIconMinus.src="icon/minus-button-hover.svg":this.svgIconMinus.src="icon/minus-button.svg"}),this.canvas.addEventListener("mousemove",this.ref=this.hover.bind(this))}resizeImage(){this.iconClick=(t=>{t.clientX>this.canvas.getBoundingClientRect().left+this.svgMargin/2&&t.clientX<this.canvas.getBoundingClientRect().left+this.svgSize.width-this.svgMargin/2&&t.clientY>this.canvas.getBoundingClientRect().top+this.canvas.clientHeight/2-this.svgSize.height/2&&t.clientY<this.canvas.getBoundingClientRect().top+this.canvas.clientHeight/2+this.svgSize.height/2&&(this.image.width=1.1*this.image.width,this.image.height=1.1*this.image.height,this.renderCanvas()),t.clientX>this.canvas.getBoundingClientRect().left+this.canvas.clientWidth-this.svgSize.width+this.svgMargin/2&&t.clientX<this.canvas.getBoundingClientRect().left+this.canvas.clientWidth-this.svgMargin/2&&t.clientY>this.canvas.getBoundingClientRect().top+this.canvas.clientHeight/2-this.svgSize.height/2&&t.clientY<this.canvas.getBoundingClientRect().top+this.canvas.clientHeight/2+this.svgSize.height/2&&(this.image.width=.9*this.image.width,this.image.height=.9*this.image.height,this.scaleY=this.scaleY-.1,this.renderCanvas())}),this.canvas.addEventListener("click",this.refClick=this.iconClick.bind(this))}renderCanvas(){this.canvas.removeEventListener("mousemove",this.ref),this.canvas.removeEventListener("click",this.refClick),this.svgSize={width:60,height:60},this.svgMargin=20,this.image,this.ctxBack=this.canvas.getContext("2d"),this.canvas.width=this.image.width+2*(this.svgSize.width+this.svgMargin),this.canvas.height=this.image.height,this.imageCentringX=(this.canvas.width-this.image.width)/2,this.ctxBack.fillStyle="#ededed",this.ctxBack.fillRect(0,0,this.canvas.width,this.canvas.height),this.ctx=this.canvas.getContext("2d"),this.ctx.save(),this.ctx.drawImage(this.image,this.imageCentringX,0,this.image.width,this.image.height),this.ctx.restore(),this.canvasControls(),this.iconHover(),this.resizeImage()}controller(){this.renderCanvas(),this.form.addEventListener("click",t=>{this.brightnessWrapper.style.display="none",this.contrastWrapper.style.display="none";for(let t=0;t<this.asideInput.length;t++)this.asideInput[t].checked&&"rotate"===this.asideInput[t].id?this.rotate():this.asideInput[t].checked&&"size"===this.asideInput[t].id?this.renderCanvas():this.asideInput[t].checked&&"gray"===this.asideInput[t].id?(this.renderCanvas(),d.greyScale()):this.asideInput[t].checked&&"inversion"===this.asideInput[t].id?(this.renderCanvas(),d.inversion()):this.asideInput[t].checked&&"brightness"===this.asideInput[t].id?(this.brightnessWrapper.style.display="block",this.rangeBrightness=document.querySelector("#range-brightness"),this.rangeBrightness.addEventListener("change",()=>{this.renderCanvas(),d.brightness()})):this.asideInput[t].checked&&"contrast"===this.asideInput[t].id&&(this.contrastWrapper.style.display="block",this.rangeContrast=document.querySelector("#range-contrast"),this.rangeContrast.addEventListener("change",()=>{this.renderCanvas(),d.contrast()}))})}rotate(){this.rotateButton=document.querySelector(".content__rotate-button"),this.angel=90,this.rotateButton.addEventListener("click",()=>{switch(this.canvas.removeEventListener("mousemove",this.ref),this.canvas.removeEventListener("click",this.refClick),this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height),this.canvas.width=this.image.width,this.canvas.height=this.image.height,this.ctx.save(),this.angel){case 90:this.canvas.width=this.image.height,this.canvas.height=this.image.width,this.ctx.translate(this.canvas.width,0);break;case 180:this.ctx.translate(this.canvas.width,this.canvas.height);break;case-90:this.canvas.width=this.image.height,this.canvas.height=this.image.width,this.ctx.translate(0,this.canvas.height)}this.ctx.rotate(this.angel*Math.PI/180),this.ctx.drawImage(this.image,0,0,this.image.width,this.image.height),this.ctx.restore(),this.angel<180?this.angel+=90:this.angel=-90})}save(){this.contentSave=document.querySelector(".content__save"),this.contentSave.style.display="block";const t=document.querySelector(".content__save-button");t.removeEventListener("click",this.refSaveEvent),this.saveEvent=(e=>{if(e.target===t){this.canvasSave=document.createElement("canvas"),this.ctxSave=this.canvasSave.getContext("2d");for(let t=0;t<this.asideInput.length;t++)this.asideInput[t].checked&&("size"===this.asideInput[t].id||"gray"===this.asideInput[t].id||"inversion"===this.asideInput[t].id||"rotate"===this.asideInput[t].id&&90===this.angel||"brightness"===this.asideInput[t].id||"contrast"===this.asideInput[t].id)?(this.canvasSave.width=this.canvas.width-(this.canvas.width-this.image.width),this.canvasSave.height=this.canvas.height-(this.canvas.height-this.image.height),this.ctxSave.drawImage(this.canvas,-this.imageCentringX,0)):this.asideInput[t].checked&&"rotate"===this.asideInput[t].id&&(this.canvasSave.width=this.canvas.width,this.canvasSave.height=this.canvas.height,this.ctxSave.drawImage(this.canvas,0,0));this.canvasSave.toBlob(function(t){c()(t,"image.png")})}}),t.addEventListener("click",this.refSaveEvent=this.saveEvent.bind(this))}}).loadImageReader();const g=document.querySelector(".aside___form"),l=(document.querySelector("#size"),document.querySelectorAll(".aside__icon")),v=document.querySelectorAll(".aside__input");v[0].checked=!0;const u=()=>{for(let t=0;t<v.length;t++)!0===v[t].checked?l[t].style.fill="#0023ff":l[t].style.fill="black"};g.addEventListener("click",t=>{u()})}]);